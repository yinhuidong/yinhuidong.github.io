<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Mongo使用篇 | 二十</title><meta name="keywords" content="MongoDB"><meta name="author" content="二十"><meta name="copyright" content="二十"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Mongo使用篇">
<meta property="og:type" content="article">
<meta property="og:title" content="Mongo使用篇">
<meta property="og:url" content="https://yinhuidong.github.io/2022/01/12/MongoDB/Mongo%E5%9F%BA%E6%93%8D/index.html">
<meta property="og:site_name" content="二十">
<meta property="og:description" content="Mongo使用篇">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yinhuidong.github.io/images/cover/MongoDB.png">
<meta property="article:published_time" content="2022-01-12T00:19:55.249Z">
<meta property="article:modified_time" content="2022-01-12T00:19:55.250Z">
<meta property="article:author" content="二十">
<meta property="article:tag" content="MongoDB">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yinhuidong.github.io/images/cover/MongoDB.png"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://yinhuidong.github.io/2022/01/12/MongoDB/Mongo%E5%9F%BA%E6%93%8D/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":800},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Mongo使用篇',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-01-12 08:19:55'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><meta name="referrer" content="no-referrer" /><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">128</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/%E5%85%B3%E4%BA%8E%E6%88%91/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/images/cover/MongoDB.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">二十</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/%E5%85%B3%E4%BA%8E%E6%88%91/"><i class="fa-fw fas fa-user"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Mongo使用篇</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-01-12T00:19:55.249Z" title="发表于 2022-01-12 08:19:55">2022-01-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-01-12T00:19:55.250Z" title="更新于 2022-01-12 08:19:55">2022-01-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MongoDB/">MongoDB</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>20分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Mongo使用篇"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="一，Mongo简介"><a href="#一，Mongo简介" class="headerlink" title="一，Mongo简介"></a>一，Mongo简介</h1><p><strong>文档数据库</strong><br>MongoDB中的记录是一个文档，它是由字段和值对组成的数据结构。MongoDB文档类似于JSON对象。字段的值可以包括其他文档，数组和文档数组。<br><img src="https://cdn.nlark.com/yuque/0/2021/png/12610368/1620787092065-b323de57-7714-4447-a106-f1321f76686b.png#clientId=u131943d5-4618-4&from=paste&height=85&id=tFZ8B&margin=%5Bobject%20Object%5D&name=image.png&originHeight=170&originWidth=570&originalType=binary&size=14262&status=done&style=none&taskId=uaff4a098-6497-4c49-8297-b3053486397&width=285" alt="image.png"><br>使用文档的优点是：</p>
<ul>
<li>文档对应编程语言中的数据类型</li>
<li>嵌入式文档减少了对连接的需求</li>
<li>动态模式支持流畅的多态性</li>
</ul>
<p><strong>​</strong></p>
<p><strong>集合/视图/按需实例化视图</strong><br>mongo将文档存储在集合中。集合类似于关系数据库中的表。<br>除集合外，Mongo还支持：</p>
<ul>
<li>只读视图</li>
<li>按需实例化视图</li>
</ul>
<p><strong>主要特性</strong><br><strong>高性能</strong><br>Mongo提供高性能的数据持久化。特别是，</p>
<ul>
<li>对嵌入式数据模型的支持减少了数据库系统上的IO操作</li>
<li>索引支持更快的查询，并且可以包含来自嵌入式文档和数组的键</li>
</ul>
<p><strong>丰富的查询语言</strong><br>Mongo支持丰富的查询语言以支持读写操作以及：</p>
<ul>
<li>数据聚合</li>
<li>文本搜索和地理空间查询</li>
</ul>
<p><strong>高可用</strong><br>Mongo的复制工具–副本集 提供：</p>
<ul>
<li>自动故障转移</li>
<li>数据冗余</li>
</ul>
<p>副本集是一组维护相同数据集合的mongod实例，提供了冗余和提高了数据可用性。<br><strong>水平扩展</strong><br>Mongo提供水平可伸缩性作为其核心功能的一部分：</p>
<ul>
<li>分片将数据分布在集群的机器上</li>
<li>从3.4开始，mongo支持基于分片键创建数据区域。在平衡集群中，mongo仅将区域覆盖的读写定向到区域内的那些分片。</li>
</ul>
<p><strong>支持多种存储引擎</strong><br>Mongo支持多种存储引擎</p>
<ul>
<li>WiredTiger存储引擎（包括对静态加密的支持）</li>
<li>内存存储引擎</li>
</ul>
<p>另外，mongo提供课插拔的存储引擎API，允许自己来发存储引擎。</p>
<h1 id="二，下载，安装，启动"><a href="#二，下载，安装，启动" class="headerlink" title="二，下载，安装，启动"></a>二，下载，安装，启动</h1><h2 id="1-mongo安装"><a href="#1-mongo安装" class="headerlink" title="1.mongo安装"></a>1.mongo安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo docker search mongo</span><br><span class="line">sudo docker pull mongo </span><br></pre></td></tr></table></figure>


<h2 id="2-mongo启动"><a href="#2-mongo启动" class="headerlink" title="2.mongo启动"></a>2.mongo启动</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -d  -p 27017:27017  --name mongodb -e MONGO_INITDB_ROOT_USERNAME=root -e MONGO_INITDB_ROOT_PASSWORD=root mongo</span><br><span class="line">sudo service mongod start</span><br></pre></td></tr></table></figure>


<p>此时可以通过 <code>/var/log/mongodb/mongod.log</code>文件观察服务启动情况。</p>
<h2 id="3-启动测试"><a href="#3-启动测试" class="headerlink" title="3.启动测试"></a>3.启动测试</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;mongo</span><br><span class="line">&gt;db</span><br></pre></td></tr></table></figure>


<h2 id="4-配置文件位置"><a href="#4-配置文件位置" class="headerlink" title="4.配置文件位置"></a>4.配置文件位置</h2><p><code>/etc/mongodb.conf</code></p>
<h2 id="5-基础配置"><a href="#5-基础配置" class="headerlink" title="5.基础配置"></a>5.基础配置</h2><ul>
<li><p>bindIp: 127.0.0.1”一行注释掉</p>
</li>
<li><p>MongoDB默认情况下将数据文件及日志文件分别存放在/var/lib/mongodb及/var/log/mongodb下，我们可以通过配置文件更改默认路径： </p>
<ul>
<li>将storage中的dbPath和systemLog中的path属性分别改成我们期望的路径</li>
<li>通过以下命令行启动MongoDB后台进程 mongod -f /etc/mongod.conf &amp;</li>
</ul>
</li>
<li><p>默认端口 27017</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://docs.mongoing.com/">中文文档</a></p>
<h1 id="三，MongoDB基本操作"><a href="#三，MongoDB基本操作" class="headerlink" title="三，MongoDB基本操作"></a>三，MongoDB基本操作</h1><h2 id="1-基本概念"><a href="#1-基本概念" class="headerlink" title="1.基本概念"></a>1.基本概念</h2><table>
<thead>
<tr>
<th>SQL术语/概念</th>
<th>Mongo术语/概念</th>
<th>解释/说明</th>
</tr>
</thead>
<tbody><tr>
<td>database</td>
<td>database</td>
<td>数据库</td>
</tr>
<tr>
<td>table</td>
<td>collection</td>
<td>数据库表/集合</td>
</tr>
<tr>
<td>row</td>
<td>document</td>
<td>数据记录行/文档</td>
</tr>
<tr>
<td>column</td>
<td>field</td>
<td>数据字段/域</td>
</tr>
<tr>
<td>index</td>
<td>index</td>
<td>索引</td>
</tr>
<tr>
<td>table joins</td>
<td></td>
<td>表连接,MongoDB不支持</td>
</tr>
<tr>
<td>primary key</td>
<td>primary key</td>
<td>主键,MongoDB自动将_id字段设置为主键</td>
</tr>
</tbody></table>
</li>
</ul>
<h2 id="2-数据库以及表的操作"><a href="#2-数据库以及表的操作" class="headerlink" title="2.数据库以及表的操作"></a>2.数据库以及表的操作</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#查看所有数据库</span><br><span class="line">&gt; show dbs</span><br><span class="line">local	0.078125GB</span><br><span class="line"></span><br><span class="line">#通过use关键字切换数据库</span><br><span class="line">&gt; use admin</span><br><span class="line">switched to db admin</span><br><span class="line"></span><br><span class="line">#创建数据库</span><br><span class="line">#说明:在MongoDB中,数据库是自动创建的,通过use切换到新数据库中,进行插入数据即可自动创建数据库</span><br><span class="line">&gt; db.user.insert(&#123;id:1,name:&#x27;zhangsan&#x27;&#125;)</span><br><span class="line">&gt; show dbs</span><br><span class="line">admin	0.203125GB</span><br><span class="line">local	0.078125GB</span><br><span class="line"></span><br><span class="line">#查看表</span><br><span class="line">&gt; show tables</span><br><span class="line">system.indexes</span><br><span class="line">user</span><br><span class="line"></span><br><span class="line">#删除集合(表)</span><br><span class="line">&gt; db.user.drop()</span><br><span class="line">true #如果成功删除选定集合,则 drop() 方法返回 true,否则返回 false。</span><br><span class="line"></span><br><span class="line">#删除数据库</span><br><span class="line"> &gt; use testdb #先切换到要删除的数据中</span><br><span class="line"> switched to db testdb</span><br><span class="line"> &gt; db.dropDatabase() #删除数据库</span><br><span class="line">&#123; &quot;dropped&quot; : &quot;testdb&quot;, &quot;ok&quot; : 1 &#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-新增数据"><a href="#3-新增数据" class="headerlink" title="3.新增数据"></a>3.新增数据</h2><p>在MongoDB中,存储的文档结构是一种类似于json的结构,称之为bson(全称为:BinaryJSON)。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> #语法:db.COLLECTION_NAME.insert(document)</span><br><span class="line"> &gt; db.user.insert(&#123;id:1,username:&#x27;zhangsan&#x27;,age:20&#125;)</span><br><span class="line"> WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)</span><br><span class="line"> &gt; db.user.save(&#123;id:2,username:&#x27;lisi&#x27;,age:25&#125;)</span><br><span class="line"> WriteResult(&#123; &quot;nInserted&quot; : 1 &#125;)</span><br><span class="line"> &gt; db.user.find() #查询数据</span><br><span class="line"> &#123; &quot;_id&quot; : ObjectId(&quot;5c08c0024b318926e0c1f6dc&quot;), &quot;id&quot; : 1, &quot;username&quot; : &quot;zhangsan&quot;,</span><br><span class="line">&quot;age&quot; : 20 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0134b318926e0c1f6dd&quot;), &quot;id&quot; : 2, &quot;username&quot; : &quot;lisi&quot;,</span><br><span class="line">&quot;age&quot; : 25 &#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-更新数据"><a href="#4-更新数据" class="headerlink" title="4.更新数据"></a>4.更新数据</h2><p>update() 方法用于更新已存在的文档。语法格式如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">db.collection.update(</span><br><span class="line">  &lt;query&gt;,</span><br><span class="line">  &lt;update&gt;,</span><br><span class="line">  [</span><br><span class="line">    upsert: &lt;boolean&gt;,</span><br><span class="line">    multi: &lt;boolean&gt;,</span><br><span class="line">    writeConcern: &lt;document&gt;</span><br><span class="line">  ]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><strong>参数说明：</strong></p>
<ul>
<li>query : update的查询条件,类似sql update查询内where后面的。</li>
<li>update : update的对象和一些更新的操作符(如 inc…)等,也可以理解为sql update查询内set后面的</li>
<li>upsert : 可选,这个参数的意思是,如果不存在update的记录,是否插入objNew,true为插入,默认是false,不插入。</li>
<li>multi : 可选,mongodb 默认是false,只更新找到的第一条记录,如果这个参数为true,就把按条件查出来多条记录全部更新。</li>
<li>writeConcern :可选,抛出异常的级别。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.user.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0024b318926e0c1f6dc&quot;), &quot;id&quot; : 1, &quot;username&quot; : &quot;zhangsan&quot;,</span><br><span class="line">&quot;age&quot; : 20 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0134b318926e0c1f6dd&quot;), &quot;id&quot; : 2, &quot;username&quot; : &quot;lisi&quot;,</span><br><span class="line">&quot;age&quot; : 25 &#125;</span><br><span class="line"></span><br><span class="line">&gt; db.user.update(&#123;id:1&#125;,&#123;$set:&#123;age:22&#125;&#125;) #更新数据</span><br><span class="line"></span><br><span class="line">WriteResult(&#123; &quot;nMatched&quot; : 1, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 1 &#125;)</span><br><span class="line"></span><br><span class="line">&gt; db.user.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0024b318926e0c1f6dc&quot;), &quot;id&quot; : 1, &quot;username&quot; : &quot;zhangsan&quot;,</span><br><span class="line">&quot;age&quot; : 22 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0134b318926e0c1f6dd&quot;), &quot;id&quot; : 2, &quot;username&quot; : &quot;lisi&quot;,</span><br><span class="line">&quot;age&quot; : 25 &#125;</span><br><span class="line"></span><br><span class="line">#注意:如果这样写,会删除掉其他的字段</span><br><span class="line">&gt; db.user.update(&#123;id:1&#125;,&#123;age:25&#125;)</span><br><span class="line">WriteResult(&#123; &quot;nMatched&quot; : 1, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 1 &#125;)</span><br><span class="line">&gt; db.user.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0024b318926e0c1f6dc&quot;), &quot;age&quot; : 25 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0134b318926e0c1f6dd&quot;), &quot;id&quot; : 2, &quot;username&quot; : &quot;lisi&quot;,</span><br><span class="line">&quot;age&quot; : 25 &#125;</span><br><span class="line"></span><br><span class="line">#更新不存在的字段,会新增字段</span><br><span class="line">&gt; db.user.update(&#123;id:2&#125;,&#123;$set:&#123;sex:1&#125;&#125;) #更新数据</span><br><span class="line">&gt; db.user.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0024b318926e0c1f6dc&quot;), &quot;age&quot; : 25 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0134b318926e0c1f6dd&quot;), &quot;id&quot; : 2, &quot;username&quot; : &quot;lisi&quot;,</span><br><span class="line">&quot;age&quot; : 25, &quot;sex&quot; : 1 &#125;</span><br><span class="line"></span><br><span class="line">#更新不存在的数据,默认不会新增数据</span><br><span class="line">&gt; db.user.update(&#123;id:3&#125;,&#123;$set:&#123;sex:1&#125;&#125;)</span><br><span class="line">WriteResult(&#123; &quot;nMatched&quot; : 0, &quot;nUpserted&quot; : 0, &quot;nModified&quot; : 0 &#125;)</span><br><span class="line">&gt; db.user.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0024b318926e0c1f6dc&quot;), &quot;age&quot; : 25 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0134b318926e0c1f6dd&quot;), &quot;id&quot; : 2, &quot;username&quot; : &quot;lisi&quot;,</span><br><span class="line">&quot;age&quot; : 25, &quot;sex&quot; : 1 &#125;</span><br><span class="line"></span><br><span class="line">#如果设置第一个参数为true,就是新增数据</span><br><span class="line">&gt; db.user.update(&#123;id:3&#125;,&#123;$set:&#123;sex:1&#125;&#125;,true)</span><br><span class="line">WriteResult(&#123;</span><br><span class="line">  &quot;nMatched&quot; : 0,</span><br><span class="line">  &quot;nUpserted&quot; : 1,</span><br><span class="line">  &quot;nModified&quot; : 0,</span><br><span class="line">  &quot;_id&quot; : ObjectId(&quot;5c08cb281418d073246bc642&quot;)</span><br><span class="line">&#125;)</span><br><span class="line">&gt; db.user.find()</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0024b318926e0c1f6dc&quot;), &quot;age&quot; : 25 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08c0134b318926e0c1f6dd&quot;), &quot;id&quot; : 2, &quot;username&quot; : &quot;lisi&quot;,</span><br><span class="line">&quot;age&quot; : 25, &quot;sex&quot; : 1 &#125;</span><br><span class="line">&#123; &quot;_id&quot; : ObjectId(&quot;5c08cb281418d073246bc642&quot;), &quot;id&quot; : 3, &quot;sex&quot; : 1 &#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-删除数据"><a href="#5-删除数据" class="headerlink" title="5.删除数据"></a>5.删除数据</h2>通过remove()方法进行删除数据,语法如下:<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">db.collection.remove(</span><br><span class="line">    &lt;query&gt;,</span><br><span class="line">    &#123;</span><br><span class="line">        justOne: &lt;<span class="keyword">boolean</span>&gt;,</span><br><span class="line">        writeConcern: &lt;document&gt;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>参数说明：</strong></p>
<ul>
<li><p>query :(可选)删除的文档的条件。</p>
</li>
<li><p>justOne : (可选)如果设为 true 或 1,则只删除一个文档,如果不设置该参数,或使用默认值 false,则删除所有匹配条件的文档。</p>
</li>
<li><p>writeConcern :(可选)抛出异常的级别。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.user.remove(&#123;age:25&#125;)</span><br><span class="line">WriteResult(&#123; &quot;nRemoved&quot; : 2 &#125;) #删除了2条数据</span><br><span class="line"></span><br><span class="line">#插入4条测试数据</span><br><span class="line">db.user.insert(&#123;id:1,username:&#x27;zhangsan&#x27;,age:20&#125;)</span><br><span class="line">db.user.insert(&#123;id:2,username:&#x27;zhangsan&#x27;,age:21&#125;)</span><br><span class="line">db.user.insert(&#123;id:3,username:&#x27;zhangsan&#x27;,age:22&#125;)</span><br><span class="line">db.user.insert(&#123;id:4,username:&#x27;zhangsan&#x27;,age:23&#125;)</span><br><span class="line"></span><br><span class="line"> &gt; db.user.remove(&#123;age:22&#125;,true)</span><br><span class="line"> WriteResult(&#123; &quot;nRemoved&quot; : 1 &#125;) #删除了1条数据</span><br><span class="line"></span><br><span class="line"> #删除所有数据</span><br><span class="line"> &gt; db.user.remove(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"> #说明:为了简化操作,官方推荐使用deleteOne()与deleteMany()进行删除数据操作。</span><br><span class="line">db.user.deleteOne(&#123;id:1&#125;)</span><br><span class="line"> db.user.deleteMany(&#123;&#125;) #删除所有数据</span><br></pre></td></tr></table></figure>
<h2 id="6-查询数据"><a href="#6-查询数据" class="headerlink" title="6.查询数据"></a>6.查询数据</h2><p>MongoDB 查询数据的语法格式如下:<br><code>db.user.find([query],[fields])</code></p>
</li>
<li><p>query :可选,使用查询操作符指定查询条件</p>
</li>
<li><p>fields :可选,使用投影操作符指定返回的键。查询时返回文档中所有键值, 只需省略该参数即可(默认省略)。</p>
</li>
</ul>
<p>如果你需要以易读的方式来读取数据,可以使用 pretty() 方法,语法格式如下:<br><code>db.col.find().pretty()</code><br>pretty() 方法以格式化的方式来显示所有文档。<br>条件查询:</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>格式</th>
<th>范例</th>
<th>RDBMS中的类似语句</th>
</tr>
</thead>
<tbody><tr>
<td>等于</td>
<td>{<key>:<value> }</td>
<td>db.col.find({“by”:”yhd”}).pretty()</td>
<td>where by = ‘yhd</td>
</tr>
<tr>
<td>小于</td>
<td>{<key>:{$lt:<value>}}</td>
<td>db.col.find({“likes”:小于{$lt:50}}).pretty()</td>
<td>where likes &lt; 50</td>
</tr>
<tr>
<td>小于或等于</td>
<td>{<key>:{$lte:<value>}}</td>
<td>db.col.find({“likes”:{$lte:50}}).pretty()</td>
<td>where likes &lt;=50</td>
</tr>
<tr>
<td>大于</td>
<td>{<key>:{$gt:<value>}}</td>
<td>db.col.find({“likes”:{$gt:50}}).pretty()</td>
<td>where likes &gt; 50</td>
</tr>
<tr>
<td>大于或等于</td>
<td>{<key>:{$gte:<value>}}</td>
<td>db.col.find({“likes”:{$gte:50}}).pretty()</td>
<td>where likes &gt;=50</td>
</tr>
<tr>
<td>不等于</td>
<td>{<key>:{$ne:<value>}}</td>
<td>db.col.find({“likes”:{$ne:50}}).pretty()</td>
<td>where likes !=50</td>
</tr>
</tbody></table>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#插入测试数据</span><br><span class="line">db.user.insert(&#123;id:1,username:&#x27;zhangsan&#x27;,age:20&#125;)</span><br><span class="line">db.user.insert(&#123;id:1,username:&#x27;zhangsan&#x27;,age:20&#125;)</span><br><span class="line">db.user.insert(&#123;id:1,username:&#x27;zhangsan&#x27;,age:20&#125;)</span><br><span class="line">db.user.insert(&#123;id:1,username:&#x27;zhangsan&#x27;,age:20&#125;)</span><br><span class="line"></span><br><span class="line">db.user.find() #查询全部数据</span><br><span class="line">db.user.find(&#123;&#125;,&#123;id:1,username:1&#125;) #只查询id与username字段</span><br><span class="line">db.user.find().count() #查询数据条数</span><br><span class="line">db.user.find(&#123;id:1&#125;) #查询id为1的数据</span><br><span class="line">db.user.find(&#123;age:&#123;$lte:21&#125;&#125;) #查询小于等于21的数据</span><br><span class="line">db.user.find(&#123;age:&#123;$lte:21&#125;, id:&#123;$gte:2&#125;&#125;) #and查询,age小于等于21并且id大于等于2</span><br><span class="line">db.user.find(&#123;$or:[&#123;id:1&#125;,&#123;id:2&#125;]&#125;) #查询id=1 or id=2</span><br><span class="line"></span><br><span class="line">#分页查询:Skip()跳过几条,limit()查询条数</span><br><span class="line">db.user.find().limit(2).skip(1) #跳过1条数据,查询2条数据</span><br><span class="line"></span><br><span class="line">db.user.find().sort(&#123;id:-1&#125;) #按照age倒序排序,-1为倒序,1为正序</span><br></pre></td></tr></table></figure>
<h1 id="四，索引"><a href="#四，索引" class="headerlink" title="四，索引"></a>四，索引</h1><p>索引通常能够极大的提高查询的效率,如果没有索引,MongoDB在读取数据时必须扫描集合中的每个文件并选取那些符合查询条件的记录。<br>这种扫描全集合的查询效率是非常低的,特别在处理大量的数据时,查询可以要花费几十秒甚至几分钟,这对网站的性能是非常致命的。<br>索引是特殊的数据结构,索引存储在一个易于遍历读取的数据集合中,索引是对数据库表中一列或多列的值进行排序的一种结构。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#查看索引</span><br><span class="line">&gt; db.user.getIndexes()</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;v&quot; : 2,</span><br><span class="line">    &quot;key&quot; : &#123;</span><br><span class="line">    	&quot;_id&quot; : 1</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;name&quot; : &quot;_id_&quot;,</span><br><span class="line">    &quot;ns&quot; : &quot;testdb.user&quot;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line">#说明:1表示升序创建索引,-1表示降序创建索引。</span><br><span class="line"></span><br><span class="line">#创建索引</span><br><span class="line">&gt; db.user.createIndex(&#123;&#x27;age&#x27;:1&#125;)</span><br><span class="line">&#123;</span><br><span class="line">  &quot;createdCollectionAutomatically&quot; : false,</span><br><span class="line">  &quot;numIndexesBefore&quot; : 1,</span><br><span class="line">  &quot;numIndexesAfter&quot; : 2,</span><br><span class="line">  &quot;ok&quot; : 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#删除索引</span><br><span class="line">db.user.dropIndex(&quot;age_1&quot;)</span><br><span class="line">#或者,删除除了_id之外的索引</span><br><span class="line">db.user.dropIndexes()</span><br><span class="line"></span><br><span class="line">#创建联合索引</span><br><span class="line">db.user.createIndex(&#123;&#x27;age&#x27;:1,&#x27;id&#x27;:-1&#125;)</span><br><span class="line"></span><br><span class="line">#查看索引大小,单位:字节</span><br><span class="line">db.user.totalIndexSize()</span><br></pre></td></tr></table></figure>
<h1 id="五，执行计划"><a href="#五，执行计划" class="headerlink" title="五，执行计划"></a>五，执行计划</h1><p>MongoDB 查询分析可以确保我们建议的索引是否有效,是查询语句性能分析的重要工具。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#插入1000条数据</span><br><span class="line">for(var i=1;i&lt;1000;i++)db.user.insert(&#123;id:100+i,username:&#x27;name_&#x27;+i,age:10+i&#125;)</span><br><span class="line"></span><br><span class="line">#查看执行计划</span><br><span class="line">db.user.find(&#123;age:&#123;$gt:100&#125;,id:&#123;$lt:200&#125;&#125;).explain()</span><br><span class="line"></span><br><span class="line"> #查询方式,常见的有COLLSCAN/全表扫描、IXSCAN/索引扫描、FETCH/根据索引去检索文档、SHARD_MERGE/合并分片结果、IDHACK/针对_id进行查询</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#测试没有使用索引</span><br><span class="line">db.user.find(&#123;username:&#x27;zhangsan&#x27;&#125;).explain()</span><br></pre></td></tr></table></figure>
<h1 id="六，UI客户端"><a href="#六，UI客户端" class="headerlink" title="六，UI客户端"></a>六，UI客户端</h1><p>Robo 3T是MongoDB的客户端工具,我们可以使用它来操作MongoDB。<br>​</p>
<h1 id="七，java连接Mongo基本CRUD"><a href="#七，java连接Mongo基本CRUD" class="headerlink" title="七，java连接Mongo基本CRUD"></a>七，java连接Mongo基本CRUD</h1><h2 id="1-依赖jar包"><a href="#1-依赖jar包" class="headerlink" title="1.依赖jar包"></a>1.依赖jar包</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mongodb<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mongo-java-driver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="2-获取连接工具类"><a href="#2-获取连接工具类" class="headerlink" title="2.获取连接工具类"></a>2.获取连接工具类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * mongodb 连接数据库工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MongoDBUtil</span> </span>&#123;</span><br><span class="line">    <span class="comment">//不通过认证获取连接数据库对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MongoDatabase <span class="title">getConnect</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//连接到 mongodb 服务</span></span><br><span class="line">        MongoClient mongoClient = <span class="keyword">new</span> MongoClient(<span class="string">&quot;localhost&quot;</span>, <span class="number">27017</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//连接到数据库</span></span><br><span class="line">        MongoDatabase mongoDatabase = mongoClient.getDatabase(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//返回连接数据库对象</span></span><br><span class="line">        <span class="keyword">return</span> mongoDatabase;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//需要密码认证方式连接</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MongoDatabase <span class="title">getConnect2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;ServerAddress&gt; adds = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">//ServerAddress()两个参数分别为 服务器地址 和 端口</span></span><br><span class="line">        ServerAddress serverAddress = <span class="keyword">new</span> ServerAddress(<span class="string">&quot;localhost&quot;</span>, <span class="number">27017</span>);</span><br><span class="line">        adds.add(serverAddress);</span><br><span class="line">        </span><br><span class="line">        List&lt;MongoCredential&gt; credentials = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">//MongoCredential.createScramSha1Credential()三个参数分别为 用户名 数据库名称 密码</span></span><br><span class="line">        MongoCredential mongoCredential = MongoCredential.createScramSha1Credential(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;databaseName&quot;</span>, <span class="string">&quot;password&quot;</span>.toCharArray());</span><br><span class="line">        credentials.add(mongoCredential);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//通过连接认证获取MongoDB连接</span></span><br><span class="line">        MongoClient mongoClient = <span class="keyword">new</span> MongoClient(adds, credentials);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//连接到数据库</span></span><br><span class="line">        MongoDatabase mongoDatabase = mongoClient.getDatabase(<span class="string">&quot;test&quot;</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//返回连接数据库对象</span></span><br><span class="line">        <span class="keyword">return</span> mongoDatabase;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="3-增删改查"><a href="#3-增删改查" class="headerlink" title="3.增删改查"></a>3.增删改查</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 插入数据</span></span><br><span class="line"><span class="comment"> * mongoDB中的数据都是通过文档（对应于关系型数据库表中的一行）保存的，而文档又保存在集合（对应于关系型数据库的表）中。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1.获取集合 这里的yhd指的是集合的名字 如果指定的集合不存在  mongoDB会在你第一次插入文档时创建集合</span></span><br><span class="line">    MongoCollection&lt;Document&gt; collection = MongoDBUtil.getConnect().getCollection(<span class="string">&quot;yhd&quot;</span>);</span><br><span class="line">    <span class="comment">//2.创建文档  要插入文档需要先创建文档对象</span></span><br><span class="line">    Document document = <span class="keyword">new</span> Document(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三&quot;</span>).append(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;20&quot;</span>).append(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line">    <span class="comment">//3.插入文档</span></span><br><span class="line">    <span class="comment">//3.1 插入一个文档 使用 MongoCollection 对象的 insertOne() 方法，该方法接收一个 Document 对象作为要插入的数据</span></span><br><span class="line">    collection.insertOne(document);</span><br><span class="line">    <span class="comment">//3.2 插入一堆文档 使用 MongoCollection 对象的 insertMany() 方法，该方法接收一个 数据类型为 Document 的 List 对象作为要插入的数据</span></span><br><span class="line">    collection.insertMany(list());</span><br><span class="line">    <span class="comment">//4.查询文档 使用 MongoCollection 对象的 find() 方法，该方法有多个重载方法，可以使用不带参数的 find() 方法查询集合中的所有文档，</span></span><br><span class="line">    <span class="comment">// 也可以通过传递一个 Bson 类型的 过滤器查询符合条件的文档。这几个重载方法均返回一个 FindIterable 类型的对象，</span></span><br><span class="line">    <span class="comment">// 可通过该对象遍历出查询到的所有文档。</span></span><br><span class="line">    <span class="comment">//4.1简单查询</span></span><br><span class="line">    FindIterable&lt;Document&gt; documents = collection.find();</span><br><span class="line">    MongoCursor&lt;Document&gt; iterator = documents.iterator();</span><br><span class="line">    <span class="keyword">while</span> (iterator.hasNext())&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;iterator.next() = &quot;</span> + iterator.next());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//4.2带过滤器查询</span></span><br><span class="line">    Bson query = Filters.eq(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    FindIterable&lt;Document&gt; result = collection.find(query);</span><br><span class="line">    MongoCursor&lt;Document&gt; cursor = result.iterator();</span><br><span class="line">    <span class="keyword">while</span> (cursor.hasNext())&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;cursor.next() = &quot;</span> + cursor.next());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//4.3 取出查询的第一个文档</span></span><br><span class="line">    Document first = result.first();</span><br><span class="line">    System.out.println(<span class="string">&quot;first = &quot;</span> + first);</span><br><span class="line">    <span class="comment">//5.修改文档</span></span><br><span class="line">    <span class="comment">//5.1修改单个 使用 MongoCollection 对象的 updateOne() 方法，该方法接收两个参数，</span></span><br><span class="line">    <span class="comment">// 第一个数据类型为 Bson 的过滤器筛选出需要修改的文档，第二个参数数据类型为 Bson 指定如何修改筛选出的文档。</span></span><br><span class="line">    <span class="comment">// 然后修改过滤器筛选出的第一个文档。</span></span><br><span class="line">    Bson filter = Filters.eq(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    Document doc = <span class="keyword">new</span> Document(<span class="string">&quot;$set&quot;</span>, <span class="keyword">new</span> Document(<span class="string">&quot;age&quot;</span>, <span class="number">100</span>));</span><br><span class="line">    collection.updateOne(filter, doc);</span><br><span class="line">    <span class="comment">//5.2修改一堆 使用 MongoCollection 对象的 updateMany() 方法，该方法接收两个参数，</span></span><br><span class="line">    <span class="comment">// 第一个数据类型为 Bson 的过滤器筛选出需要修改的文档，第二个参数数据类型为 Bson 指定如何修改筛选出的文档。</span></span><br><span class="line">    <span class="comment">// 然后修改过滤器筛选出的所有文档。</span></span><br><span class="line">    collection.updateMany(filter,doc);</span><br><span class="line">    <span class="comment">//6.删除 删除与筛选器匹配的单个文档，使用 MongoCollection 对象的 deleteOne() 方法，</span></span><br><span class="line">    <span class="comment">// 该方法接收一个数据类型为 Bson 的的对象作为过滤器筛选出需要删除的文档。</span></span><br><span class="line">    <span class="comment">// 然后删除第一个。为了便于创建过滤器对象，JDBC驱动程序提供了 Filters 类。</span></span><br><span class="line">    Bson delete = Filters.eq(<span class="string">&quot;age&quot;</span>,<span class="number">18</span>);</span><br><span class="line">    collection.deleteOne(delete);</span><br><span class="line">    <span class="comment">//删除与筛选器匹配的所有文档，使用 MongoCollection 对象的 deleteMany() 方法，</span></span><br><span class="line">    <span class="comment">// 该方法接收一个数据类型为 Bson 的的对象作为过滤器筛选出需要删除的文档。然后删除所有筛选出的文档。</span></span><br><span class="line">    collection.deleteMany(delete);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> List&lt;Document&gt; <span class="title">list</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Document a = <span class="keyword">new</span> Document(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;李四&quot;</span>).append(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;21&quot;</span>).append(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line">    Document b = <span class="keyword">new</span> Document(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;王五&quot;</span>).append(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;22&quot;</span>).append(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;女&quot;</span>);</span><br><span class="line">    Document c = <span class="keyword">new</span> Document(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;赵六&quot;</span>).append(<span class="string">&quot;age&quot;</span>, <span class="string">&quot;23&quot;</span>).append(<span class="string">&quot;sex&quot;</span>, <span class="string">&quot;女&quot;</span>);</span><br><span class="line">    List&lt;Document&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    list.add(a);</span><br><span class="line">    list.add(b);</span><br><span class="line">    list.add(c);</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="八，SpringBoot整合Mongo"><a href="#八，SpringBoot整合Mongo" class="headerlink" title="八，SpringBoot整合Mongo"></a>八，SpringBoot整合Mongo</h1><p>spring-data对MongoDB做了支持,使用spring-data-mongodb可以简化MongoDB的操作。</p>
<h2 id="1-dependency"><a href="#1-dependency" class="headerlink" title="1.dependency"></a>1.dependency</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-mongodb<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="2-config"><a href="#2-config" class="headerlink" title="2.config"></a>2.config</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.application.name=spring-boot-mongo</span><br><span class="line"></span><br><span class="line">spring.data.mongodb.uri=mongodb://root:root@172.17.0.3:27017</span><br><span class="line">spring.data.mongodb.database=yhd</span><br></pre></td></tr></table></figure>
<h2 id="3-Person实体类"><a href="#3-Person实体类" class="headerlink" title="3.Person实体类"></a>3.Person实体类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-PersonDao"><a href="#4-PersonDao" class="headerlink" title="4.PersonDao"></a>4.PersonDao</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MongoTemplate mongoTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> person</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">savePerson</span><span class="params">(Person person)</span></span>&#123;</span><br><span class="line">        mongoTemplate.save(person);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 以名字为条件批量查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Person&gt; <span class="title">queryPersonListByName</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">        Query query = Query.query(Criteria.where(<span class="string">&quot;name&quot;</span>).is(name));</span><br><span class="line">        <span class="keyword">return</span> mongoTemplate.find(query,Person.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 分页查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> page</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> size</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  List&lt;Person&gt; <span class="title">queryPersonList</span><span class="params">(Integer page, Integer size)</span></span>&#123;</span><br><span class="line">        Query query = <span class="keyword">new</span> Query().limit(size).skip((page - <span class="number">1</span>) * size);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.mongoTemplate.find(query, Person.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 修改对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> person</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> UpdateResult <span class="title">update</span><span class="params">(Person person)</span></span>&#123;</span><br><span class="line">        Query query = Query.query(Criteria.where(<span class="string">&quot;id&quot;</span>).is(person.getId()));</span><br><span class="line">        Update update = Update.update(<span class="string">&quot;age&quot;</span>, person.getAge());</span><br><span class="line">        <span class="keyword">return</span> mongoTemplate.updateFirst(query,update,Person.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 删除对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DeleteResult <span class="title">deleteById</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        Query query = Query.query(Criteria.where(<span class="string">&quot;id&quot;</span>).is(id));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.mongoTemplate.remove(query, Person.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-Test"><a href="#5-Test" class="headerlink" title="5.Test"></a>5.Test</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SpringbootMongoApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PersonDao personDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testSave</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person(<span class="number">1</span>, <span class="string">&quot;张三&quot;</span>, <span class="number">20</span>, <span class="string">&quot;男&quot;</span>);</span><br><span class="line">        <span class="keyword">this</span>.personDao.savePerson(person);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testQuery</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Person&gt; personList = <span class="keyword">this</span>.personDao.queryPersonListByName(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (Person person : personList) &#123;</span><br><span class="line">            System.out.println(person);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testQuery2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Person&gt; personList = <span class="keyword">this</span>.personDao.queryPersonList(<span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (Person person : personList) &#123;</span><br><span class="line">            System.out.println(person);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person();</span><br><span class="line">        person.setId(<span class="number">1</span>);</span><br><span class="line">        person.setAge(<span class="number">30</span>);</span><br><span class="line">        <span class="keyword">this</span>.personDao.update(person);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.personDao.deleteById(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">二十</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://yinhuidong.github.io/2022/01/12/MongoDB/Mongo%E5%9F%BA%E6%93%8D/">https://yinhuidong.github.io/2022/01/12/MongoDB/Mongo基操/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://yinhuidong.github.io" target="_blank">二十</a> 许可协议。转载请注明来自 <a href="https://yinhuidong.github.io" target="_blank">二十</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/MongoDB/">MongoDB</a></div><div class="post_share"><div class="social-share" data-image="/images/cover/MongoDB.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat_pay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat_pay.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/01/12/%E4%BA%91%E8%AE%A1%E7%AE%97/Docker%E5%AD%98%E5%82%A8%E5%8E%9F%E7%90%86/"><img class="prev-cover" src="/images/cover/%E4%BA%91%E8%AE%A1%E7%AE%97.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Docker存储原理</div></div></a></div><div class="next-post pull-right"><a href="/2022/01/12/JAVA%E5%9F%BA%E7%A1%80/%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90HashMap%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86/"><img class="next-cover" src="/images/cover/JAVA.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">HashMap</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/01/12/MongoDB/Mongo%E9%9B%86%E7%BE%A4/" title="MongoDB集群篇"><img class="cover" src="/images/cover/MongoDB.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-01-12</div><div class="title">MongoDB集群篇</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">二十</div><div class="author-info__description">欢迎来到二十的博客....</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">128</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">13</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yinhuidong"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/yinhuidong" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1972039773@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎来到二十的个人博客，联系作者：VX：yinhuidong666</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%EF%BC%8CMongo%E7%AE%80%E4%BB%8B"><span class="toc-text">一，Mongo简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%EF%BC%8C%E4%B8%8B%E8%BD%BD%EF%BC%8C%E5%AE%89%E8%A3%85%EF%BC%8C%E5%90%AF%E5%8A%A8"><span class="toc-text">二，下载，安装，启动</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-mongo%E5%AE%89%E8%A3%85"><span class="toc-text">1.mongo安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-mongo%E5%90%AF%E5%8A%A8"><span class="toc-text">2.mongo启动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%90%AF%E5%8A%A8%E6%B5%8B%E8%AF%95"><span class="toc-text">3.启动测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BD%8D%E7%BD%AE"><span class="toc-text">4.配置文件位置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-text">5.基础配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%EF%BC%8CMongoDB%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-text">三，MongoDB基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">1.基本概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%A5%E5%8F%8A%E8%A1%A8%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-text">2.数据库以及表的操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%96%B0%E5%A2%9E%E6%95%B0%E6%8D%AE"><span class="toc-text">3.新增数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="toc-text">4.更新数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-text">5.删除数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE"><span class="toc-text">6.查询数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%EF%BC%8C%E7%B4%A2%E5%BC%95"><span class="toc-text">四，索引</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%EF%BC%8C%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92"><span class="toc-text">五，执行计划</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%EF%BC%8CUI%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">六，UI客户端</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%EF%BC%8Cjava%E8%BF%9E%E6%8E%A5Mongo%E5%9F%BA%E6%9C%ACCRUD"><span class="toc-text">七，java连接Mongo基本CRUD</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E4%BE%9D%E8%B5%96jar%E5%8C%85"><span class="toc-text">1.依赖jar包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%8E%B7%E5%8F%96%E8%BF%9E%E6%8E%A5%E5%B7%A5%E5%85%B7%E7%B1%BB"><span class="toc-text">2.获取连接工具类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="toc-text">3.增删改查</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%EF%BC%8CSpringBoot%E6%95%B4%E5%90%88Mongo"><span class="toc-text">八，SpringBoot整合Mongo</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-dependency"><span class="toc-text">1.dependency</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-config"><span class="toc-text">2.config</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Person%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-text">3.Person实体类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-PersonDao"><span class="toc-text">4.PersonDao</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Test"><span class="toc-text">5.Test</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/01/24/MySQL/MySQL%5B%E4%BA%8C%E5%8D%81%E5%9B%9B%5D%E4%B8%A4%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4/" title="MySQL[二十四]两阶段提交"><img src="/images/cover/mysql.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL[二十四]两阶段提交"/></a><div class="content"><a class="title" href="/2022/01/24/MySQL/MySQL%5B%E4%BA%8C%E5%8D%81%E5%9B%9B%5D%E4%B8%A4%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4/" title="MySQL[二十四]两阶段提交">MySQL[二十四]两阶段提交</a><time datetime="2022-01-23T16:00:00.000Z" title="发表于 2022-01-24 00:00:00">2022-01-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/23/MySQL/MySQL%5B%E4%BA%8C%E5%8D%81%E4%B8%89%5D%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97/" title="MySQL[二十三]二进制日志"><img src="/images/cover/mysql.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL[二十三]二进制日志"/></a><div class="content"><a class="title" href="/2022/01/23/MySQL/MySQL%5B%E4%BA%8C%E5%8D%81%E4%B8%89%5D%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97/" title="MySQL[二十三]二进制日志">MySQL[二十三]二进制日志</a><time datetime="2022-01-22T16:00:00.000Z" title="发表于 2022-01-23 00:00:00">2022-01-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/22/MySQL/MySQL%5B%E4%BA%8C%E5%8D%81%E4%BA%8C%5DCOUNT/" title="MySQL[二十二]COUNT"><img src="/images/cover/mysql.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL[二十二]COUNT"/></a><div class="content"><a class="title" href="/2022/01/22/MySQL/MySQL%5B%E4%BA%8C%E5%8D%81%E4%BA%8C%5DCOUNT/" title="MySQL[二十二]COUNT">MySQL[二十二]COUNT</a><time datetime="2022-01-21T16:00:00.000Z" title="发表于 2022-01-22 00:00:00">2022-01-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/21/MySQL/MySQL%5B%E4%BA%8C%E5%8D%81%E4%B8%80%5DLIMIT/" title="MySQL[二十一]LIMIT"><img src="/images/cover/mysql.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL[二十一]LIMIT"/></a><div class="content"><a class="title" href="/2022/01/21/MySQL/MySQL%5B%E4%BA%8C%E5%8D%81%E4%B8%80%5DLIMIT/" title="MySQL[二十一]LIMIT">MySQL[二十一]LIMIT</a><time datetime="2022-01-20T16:00:00.000Z" title="发表于 2022-01-21 00:00:00">2022-01-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/20/MySQL/MySQL%5B%E4%BA%8C%E5%8D%81%5D%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%80%BB%E7%BB%93/" title="MySQL[二十]海量数据处理"><img src="/images/cover/mysql.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL[二十]海量数据处理"/></a><div class="content"><a class="title" href="/2022/01/20/MySQL/MySQL%5B%E4%BA%8C%E5%8D%81%5D%E6%B5%B7%E9%87%8F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%80%BB%E7%BB%93/" title="MySQL[二十]海量数据处理">MySQL[二十]海量数据处理</a><time datetime="2022-01-19T16:00:00.000Z" title="发表于 2022-01-20 00:00:00">2022-01-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/images/cover/MongoDB.png')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By 二十</div><div class="footer_custom_text">树是生活，埋的是我。看花就好，别看我落魄。</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/chocolate.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="二十,二十二十,二十二十二十,二十二十二十二十,二十二十二十二十二十" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>